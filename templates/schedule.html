{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Haftalık Vardiya Planı</h2>
    <form method="post">
        {% csrf_token %}
        <button type="submit" name="generate" class="btn btn-outline-light"><i class="bi bi-arrow-repeat"></i> Planı
            Yenile</button>
    </form>
</div>

<p class="text-muted">{{ start_date }} - {{ end_date }}</p>

<div class="table-responsive card p-2">
    <table class="table table-dark table-hover mb-0">
        <thead>
            <tr>
                <th>Agent</th>
                {% for d in week_dates %}
                <th>{{ d|date:"D d M" }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in schedule_table %}
            <tr>
                <td>{{ row.agent.user.username }}<br><small class="text-muted">{{ row.agent.team }}</small></td>
                {% for shift in row.shifts %}
                <td>
                    {% if shift %}
                    <span class="badge bg-primary">
                        {{ shift.start_time|time:"H:i" }} - {{ shift.end_time|time:"H:i" }}
                    </span>
                    <br>
                    <small class="text-muted">Mola: {{ shift.break_start|time:"H:i" }}</small>
                    {% else %}
                    <span class="text-muted">-</span>
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}